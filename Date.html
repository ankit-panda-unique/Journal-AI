<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Date Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        
        /* Base styles that will be overridden by dark/light mode */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Dark mode styles (default) */
        body.dark {
            background-color: #1a202c;
            color: #e2e8f0;
        }

        .bg-card {
            background-color: #2d3748;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
        }
        
        .bg-card h1 { color: #fff; }
        .bg-card p { color: #a0aec0; }
        .bg-ai-section {
            background-color: #2d3748;
            border-color: #4a5568;
        }
        .bg-ai-section h2 { color: #d8b4fe; }
        .bg-ai-section p { color: #a0aec0; }
        .input-field {
            background-color: #1a202c;
            border-color: #4a5568;
            color: #fff;
        }

        /* Light mode styles */
        body.light {
            background-color: #f7fafc;
            color: #1f2937;
        }

        body.light .bg-card {
            background-color: #ffffff;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        body.light .bg-card h1 { color: #1f2937; }
        body.light .bg-card p { color: #4a5568; }
        body.light .bg-ai-section {
            background-color: #f0f4f8;
            border-color: #d1d8df;
        }
        body.light .bg-ai-section h2 { color: #8b5cf6; }
        body.light .bg-ai-section p { color: #4a5568; }
        body.light .input-field {
            background-color: #fff;
            border-color: #d1d8df;
            color: #1f2937;
        }

        .container {
            max-width: 900px;
            margin: auto;
            padding: 2rem;
        }
        .bg-card {
            border-radius: 1.5rem;
            padding: 2.5rem;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
        }
        button {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left-color: #fff;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen dark">
    <button id="themeToggle" class="absolute top-4 right-4 p-3 rounded-full bg-gray-500 hover:bg-gray-600 text-white transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2">
        <i id="themeIcon" class="fas fa-sun text-lg"></i>
    </button>
    <div class="container flex flex-col items-center">
        <div class="bg-card w-full mb-8">
            <h1 class="text-3xl font-bold mb-4 text-center">Manual Date Converter</h1>
            <p class="mb-6 text-center">Enter a date string like "Aug-25,28 - Sep-2,5" and convert it to an Excel-friendly format (MM-DD-YYYY).</p>
            
            <!-- AI-Powered Date String Generator -->
            <div class="mb-8 p-6 rounded-lg border bg-ai-section">
                <h2 class="text-xl font-semibold mb-3 text-center">âœ¨ AI Date String Generator</h2>
                <p class="text-sm mb-4 text-center">Describe the dates you need and I'll generate the correct input string for you.</p>
                <div class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4">
                    <input id="aiInput" type="text" placeholder="e.g., last two weeks of July" class="flex-grow p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 transition duration-200 input-field">
                    <button id="generateButton" class="w-full md:w-auto px-6 py-3 bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-semibold rounded-lg shadow-md hover:from-purple-600 hover:to-indigo-600 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-300 ease-in-out flex items-center justify-center space-x-2">
                        <div id="aiSpinner" class="hidden spinner"></div>
                        <i id="aiIcon" class="fas fa-magic"></i>
                        <span id="aiButtonText">Generate String</span>
                    </button>
                </div>
            </div>

            <!-- Manual Date Conversion Section -->
            <div class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4">
                <input id="manualInput" type="text" placeholder="e.g., Aug-25,28 - Sep-2,5" class="flex-grow p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 input-field">
                <button id="convertButton" class="w-full md:w-auto px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white font-semibold rounded-lg shadow-md hover:from-blue-600 hover:to-cyan-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-300 ease-in-out flex items-center justify-center space-x-2">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Convert Dates</span>
                </button>
                <button id="resetButton" class="w-full md:w-auto px-6 py-3 bg-gray-500 text-white font-semibold rounded-lg shadow-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition duration-300 ease-in-out flex items-center justify-center space-x-2">
                    <i class="fas fa-redo-alt"></i>
                    <span>Reset</span>
                </button>
            </div>

            <div id="manualDatesDisplay" class="mt-6">
                <div id="manualDatesList" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mt-2 w-full">
                    <!-- Converted dates will appear here -->
                </div>
            </div>

            <button id="manualCopyButton" class="mt-6 w-full md:w-auto px-6 py-3 bg-gradient-to-r from-green-500 to-teal-500 text-white font-semibold rounded-lg shadow-md hover:from-green-600 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-300 ease-in-out hidden flex items-center justify-center space-x-2">
                <i class="fas fa-clipboard"></i>
                <span>Copy Converted Dates</span>
            </button>
            <div id="manualMessage" class="mt-4 text-sm text-green-400 opacity-0 transition-opacity duration-300">
                Dates copied to clipboard!
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const aiInput = document.getElementById('aiInput');
            const generateButton = document.getElementById('generateButton');
            const aiSpinner = document.getElementById('aiSpinner');
            const aiIcon = document.getElementById('aiIcon');
            const aiButtonText = document.getElementById('aiButtonText');
            const manualInput = document.getElementById('manualInput');
            const convertButton = document.getElementById('convertButton');
            const manualDatesList = document.getElementById('manualDatesList');
            const manualCopyButton = document.getElementById('manualCopyButton');
            const manualMessage = document.getElementById('manualMessage');
            const resetButton = document.getElementById('resetButton');
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const body = document.body;

            let manualDates = [];
            
            // Function to handle the manual date conversion
            function convertManualDates() {
                const inputString = manualInput.value.trim();
                manualDates = [];
                manualDatesList.innerHTML = '';
                manualCopyButton.classList.add('hidden');

                if (!inputString) {
                    return;
                }

                const monthMap = {
                    'jan': '01', 'feb': '02', 'mar': '03', 'apr': '04', 'may': '05', 'jun': '06',
                    'jul': '07', 'aug': '08', 'sep': '09', 'oct': '10', 'nov': '11', 'dec': '12'
                };

                const parts = inputString.split(/ - /).map(part => part.trim());
                
                let currentYear = new Date().getFullYear();
                let currentMonth = null;

                parts.forEach(part => {
                    const monthMatch = part.match(/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i);
                    const daysMatch = part.match(/[\d,]+/);

                    // Check for a month name first to update the current month
                    if (monthMatch) {
                        const monthName = monthMatch[1].toLowerCase();
                        currentMonth = monthMap[monthName];
                    }

                    // Then, check for days and process them using the current month
                    if (daysMatch) {
                        const daysString = daysMatch[0];
                        const days = daysString.split(',').map(d => d.trim());
                        days.forEach(day => {
                            if (currentMonth && day) {
                                const formattedDate = `${currentMonth}-${day.padStart(2, '0')}-${currentYear}`;
                                manualDates.push(formattedDate);
                            }
                        });
                    }
                });

                manualDates.forEach(date => {
                    const p = document.createElement('p');
                    p.textContent = date;
                    p.className = 'bg-gray-700 dark:bg-gray-200 text-gray-200 dark:text-gray-700 rounded-lg p-3 text-lg font-medium text-center shadow-sm';
                    manualDatesList.appendChild(p);
                });

                if (manualDates.length > 0) {
                    manualCopyButton.classList.remove('hidden');
                }
            }

            function resetApp() {
                aiInput.value = '';
                manualInput.value = '';
                manualDates = [];
                manualDatesList.innerHTML = '';
                manualCopyButton.classList.add('hidden');
            }

            async function generateDateString() {
                const userQuery = aiInput.value.trim();
                if (!userQuery) return;

                aiSpinner.classList.remove('hidden');
                aiIcon.classList.add('hidden');
                aiButtonText.textContent = 'Generating...';
                generateButton.disabled = true;

                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const systemPrompt = "You are a helpful assistant that generates a concise date string. Given a natural language query for dates, provide the date string in the format: 'MonthName-Day,Day - MonthName-Day,Day'. For example, 'first two weeks of July' should be 'Jul-1,2,3,4,5,6,7,8,9,10,11,12,13,14'. If the user's prompt contains 'today', 'tomorrow', 'next week', 'this week', 'last week', 'next month', 'this month', or 'last month', you should provide the corresponding dates in the requested format. Use short month names (Jan, Feb, etc).";

                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "OBJECT",
                            properties: {
                                "dateString": { "type": "STRING" }
                            }
                        }
                    },
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    },
                };
                
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    const result = await response.json();
                    const candidate = result.candidates?.[0];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        const jsonString = candidate.content.parts[0].text;
                        const parsedJson = JSON.parse(jsonString);
                        if (parsedJson.dateString) {
                            manualInput.value = parsedJson.dateString;
                        }
                    } else {
                        console.error('API response error:', result);
                    }
                } catch (error) {
                    console.error('Fetch error:', error);
                } finally {
                    aiSpinner.classList.add('hidden');
                    aiIcon.classList.remove('hidden');
                    aiButtonText.textContent = 'Generate String';
                    generateButton.disabled = false;
                }
            }

            // Theme toggle logic
            function toggleTheme() {
                if (body.classList.contains('dark')) {
                    body.classList.remove('dark');
                    body.classList.add('light');
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                    localStorage.setItem('theme', 'light');
                } else {
                    body.classList.remove('light');
                    body.classList.add('dark');
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                    localStorage.setItem('theme', 'dark');
                }
            }

            // Set initial theme on page load
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                if (savedTheme === 'light') {
                    body.classList.remove('dark');
                    body.classList.add('light');
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                } else {
                    body.classList.remove('light');
                    body.classList.add('dark');
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                }
            }

            // Event Listeners
            generateButton.addEventListener('click', generateDateString);
            convertButton.addEventListener('click', convertManualDates);
            resetButton.addEventListener('click', resetApp);
            themeToggle.addEventListener('click', toggleTheme);

            manualCopyButton.addEventListener('click', () => {
                if (manualDates.length > 0) {
                    const datesToCopy = manualDates.join('\n');
                    
                    const textarea = document.createElement('textarea');
                    textarea.value = datesToCopy;
                    document.body.appendChild(textarea);
                    textarea.select();
                    try {
                        document.execCommand('copy');
                        showMessage(manualMessage);
                    } catch (err) {
                        console.error('Failed to copy text: ', err);
                    }
                    document.body.removeChild(textarea);
                }
            });

            function showMessage(element) {
                element.classList.remove('opacity-0');
                element.classList.add('opacity-100');
                setTimeout(() => {
                    element.classList.remove('opacity-100');
                    element.classList.add('opacity-0');
                }, 2000);
            }
        });
    </script>
</body>
</html>
